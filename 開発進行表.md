# 証券CRMシステム開発進行表

**プロジェクト期間**: 10週間（約2.5ヶ月）
**開始日**: 2025年9月30日
**目標**: 実用レベルのCRMシステム（フェーズ2）の完成

---

## 📊 全体進捗: 25% 完了

| フェーズ | 状態 | 進捗 |
|---------|------|------|
| Week 1-2: プロジェクト基盤構築 | ✅ 完了 | 100% |
| Week 3-4: コア業務機能実装 | 🔄 進行中 | 30% |
| Week 5-6: セキュリティ・権限管理 | ⏳ 未着手 | 0% |
| Week 7-8: ワークフロー・レポート機能 | ⏳ 未着手 | 0% |
| Week 9-10: 外部連携・品質向上 | ⏳ 未着手 | 0% |

---

## ✅ Week 1-2: プロジェクト基盤構築 (完了)

### Day 1-3: 環境セットアップ ✅
- ✅ リポジトリ作成
- ✅ Next.js 14 + TypeScript + Tailwind CSS セットアップ
- ✅ Express + TypeScript + Prisma セットアップ
- ✅ SQLite データベース設定（開発用）
- ✅ Prismaスキーマ設計
  - User, Customer, Meeting, Task, ApprovalRequest, AuditLog
- ✅ プロジェクト構造構築

### Day 4-7: 認証システム実装 ✅
- ✅ ユーザーモデルとAPI実装
- ✅ JWT認証フロー構築
  - POST /api/auth/register
  - POST /api/auth/login
  - POST /api/auth/logout
  - GET /api/auth/me
- ✅ ログイン・ログアウト画面
- ✅ 認証ミドルウェア
- ✅ 認証コンテキスト (React)
- ✅ パスワードハッシュ化 (bcrypt)

### Day 8-10: 顧客マスタ基本機能 ✅
- ✅ 顧客モデルとAPI実装
  - GET /api/customers (一覧、検索、ページネーション)
  - GET /api/customers/:id (詳細)
  - POST /api/customers (作成)
  - PUT /api/customers/:id (更新)
  - DELETE /api/customers/:id (削除)
- ✅ 顧客一覧画面
- ✅ 顧客登録フォーム
- ✅ 検索機能
- ✅ 権限によるデータフィルタリング
- ✅ 投資プロファイル管理
- ✅ 監査ログ記録

---

## 🔄 Week 3-4: コア業務機能実装 (進行中: 30%)

### Day 11-14: 商談履歴管理 🔄
**進捗: 0%**

- [ ] 商談履歴モデルとAPI
  - [ ] POST /api/meetings - 商談記録作成
  - [ ] GET /api/meetings/:id - 商談詳細
  - [ ] PUT /api/meetings/:id - 商談記録更新
  - [ ] DELETE /api/meetings/:id - 商談記録削除
  - [ ] GET /api/customers/:customerId/meetings - 顧客の商談一覧
- [ ] 商談記録フォーム（リッチテキスト対応）
- [ ] 商談履歴一覧・検索
- [ ] 顧客詳細画面との統合
- [ ] 次回アクション入力機能
- [ ] タイムライン表示

**担当**: 開発エンジニア
**期限**: Day 14

### Day 15-20: タスク・リマインダー機能 ⏳
**進捗: 0%**

- [ ] タスクモデルとAPI
  - [ ] POST /api/tasks - タスク作成
  - [ ] GET /api/tasks - タスク一覧
  - [ ] GET /api/tasks/:id - タスク詳細
  - [ ] PUT /api/tasks/:id - タスク更新
  - [ ] DELETE /api/tasks/:id - タスク削除
  - [ ] PUT /api/tasks/:id/complete - タスク完了
  - [ ] GET /api/tasks/overdue - 期限切れタスク
- [ ] タスク一覧ページ（ステータス別タブ）
- [ ] タスクカレンダービュー
- [ ] タスク作成・編集ダイアログ
- [ ] 期限アラート機能
- [ ] ダッシュボードへのタスク表示
- [ ] 商談記録後の自動タスク作成

**担当**: 開発エンジニア
**期限**: Day 20

---

## ⏳ Week 5-6: セキュリティ・権限管理 (未着手: 0%)

### Day 21-25: ロールベースアクセス制御
**進捗: 0%**

- [ ] 役割・権限テーブル設計（既存のRoleを拡張）
- [ ] 権限チェックミドルウェア強化
- [ ] APIレベルの権限制御
  - [ ] ADMIN: 全機能アクセス
  - [ ] MANAGER: チーム管理、承認権限
  - [ ] SALES: 自分の顧客のみ
  - [ ] COMPLIANCE: 全体閲覧（読取専用）
- [ ] UI上の権限による表示制御
- [ ] 役割管理画面（ADMIN用）
- [ ] 権限テストスイート

**担当**: 開発エンジニア
**期限**: Day 25

### Day 26-30: 操作ログ・監査機能
**進捗: 20%** (基本的なログ記録は実装済み)

- [x] 監査ログテーブル設計（実装済み）
- [x] 自動ログ記録（認証・顧客操作のみ）
- [ ] ログ記録の拡張
  - [ ] 商談記録操作
  - [ ] タスク操作
  - [ ] 承認申請操作
- [ ] ログ閲覧・検索画面（COMPLIANCE用）
- [ ] 変更履歴の表示（顧客詳細画面）
- [ ] ログエクスポート機能（CSV）
- [ ] ログ改ざん防止措置

**担当**: 開発エンジニア
**期限**: Day 30

---

## ⏳ Week 7-8: ワークフロー・レポート機能 (未着手: 0%)

### Day 31-37: 承認ワークフロー
**進捗: 0%**

- [ ] 承認申請モデルとAPI（スキーマは作成済み）
  - [ ] POST /api/approval-requests - 承認申請作成
  - [ ] GET /api/approval-requests - 申請一覧
  - [ ] GET /api/approval-requests/:id - 申請詳細
  - [ ] PUT /api/approval-requests/:id/approve - 承認
  - [ ] PUT /api/approval-requests/:id/reject - 却下
  - [ ] PUT /api/approval-requests/:id/recall - 取り下げ
- [ ] 申請作成画面
- [ ] 承認待ち一覧画面
- [ ] 承認アクション画面
- [ ] 通知機能（画面内通知）
- [ ] 承認履歴表示
- [ ] ワークフローステータス管理

**担当**: 開発エンジニア
**期限**: Day 37

### Day 38-42: レポート・ダッシュボード
**進捗: 0%**

- [ ] レポートAPI実装
  - [ ] GET /api/reports/sales-summary - 営業実績サマリ
  - [ ] GET /api/reports/customer-segments - 顧客セグメント分析
  - [ ] GET /api/reports/team-performance - チーム実績
  - [ ] GET /api/reports/compliance-metrics - コンプライアンス指標
- [ ] グラフ・チャート表示（Recharts導入）
- [ ] ダッシュボード画面の完成
  - [ ] 営業実績サマリ
  - [ ] タスク状況
  - [ ] 顧客セグメント分析
  - [ ] チーム実績（MANAGER向け）
  - [ ] コンプライアンス指標（COMPLIANCE向け）
- [ ] レポートのフィルタ・期間指定
- [ ] CSVエクスポート

**担当**: 開発エンジニア
**期限**: Day 42

---

## ⏳ Week 9-10: 外部連携・品質向上 (未着手: 0%)

### Day 43-49: 外部API連携基盤
**進捗: 0%**

- [ ] モックAPIサーバー構築
- [ ] 勘定系システムAPI（モック）
  - [ ] GET /mock-api/accounts/:customerId - 口座情報
  - [ ] GET /mock-api/accounts/:customerId/balance - 残高
  - [ ] GET /mock-api/accounts/:customerId/transactions - 取引履歴
- [ ] 市場データAPI（モック）
  - [ ] GET /mock-api/market/stock/:symbol - 株価情報
  - [ ] GET /mock-api/market/indices - 市場指標
- [ ] APIクライアント実装
- [ ] リトライロジック（exponential backoff）
- [ ] API呼び出しログ記録
- [ ] 接続設定管理画面（ADMIN用）
- [ ] 顧客詳細画面への統合

**担当**: 開発エンジニア
**期限**: Day 49

### Day 50-56: テスト・品質保証
**進捗: 0%**

- [ ] ユニットテストの追加（カバレッジ70%以上）
- [ ] E2Eテストスイート作成（Playwright）
  - [ ] 認証フロー
  - [ ] 顧客管理フロー
  - [ ] 商談管理フロー
  - [ ] タスク管理フロー
  - [ ] 承認ワークフロー
  - [ ] 権限制御
- [ ] セキュリティスキャン実施
- [ ] パフォーマンステスト
- [ ] バグ修正
- [ ] ドキュメント整備
- [ ] デモ環境構築

**担当**: 全員
**期限**: Day 56

### Day 57-60: 最終調整・レビュー
**進捗: 0%**

- [ ] コードレビュー
- [ ] UI/UXの最終調整
- [ ] パフォーマンス最適化
- [ ] セキュリティ最終チェック
- [ ] デプロイ手順確認
- [ ] 最終デモ準備
- [ ] プレゼンテーション資料作成

**担当**: 全員
**期限**: Day 60

---

## 📈 機能実装状況

### 実装済み機能 ✅

1. **認証・認可**
   - ユーザー登録・ログイン
   - JWT認証
   - ロールベース認証（基本）
   - 監査ログ（基本）

2. **顧客管理**
   - 顧客CRUD
   - 検索・フィルタ
   - ページネーション
   - 投資プロファイル管理
   - 権限によるデータフィルタリング

3. **UI/UX**
   - ログイン画面
   - ダッシュボード
   - 顧客一覧画面
   - 顧客登録画面
   - レスポンシブデザイン

### 実装予定機能 ⏳

1. **商談履歴管理** (Week 3)
2. **タスク管理** (Week 3-4)
3. **承認ワークフロー** (Week 7)
4. **レポート・ダッシュボード** (Week 7-8)
5. **外部API連携** (Week 9)
6. **テスト・品質保証** (Week 9-10)

---

## 🚀 次のアクション

### 今週の目標 (Week 3)
1. ✅ 顧客管理完成
2. 🔄 商談履歴管理の実装開始
3. ⏳ タスク管理の実装

### 今日のタスク
1. 商談履歴管理APIの実装
2. 商談記録フォームの作成
3. 顧客詳細画面への商談履歴統合

---

## 📝 メモ・課題

### 技術的決定事項
- ✅ 開発用にSQLiteを使用（本番はPostgreSQL予定）
- ✅ shadcn/uiベースのUIコンポーネント
- ✅ React Hook Form + Zod でバリデーション
- ✅ Axiosでの通信、自動トークン付与

### 既知の課題
1. PostgreSQL環境のセットアップ（本番用）
2. メール通知機能は後回し
3. PDFエクスポートは将来対応

### 改善予定
1. エラーハンドリングの強化
2. ローディング状態の改善
3. より詳細な監査ログ

---

## 📊 工数管理

### 使用時間
- Week 1-2: 約10時間
- Week 3: 進行中

### 予定工数
- 総計: 約80-100時間（10週間）
- 週あたり: 8-10時間

---

**最終更新**: 2025年9月30日
**更新者**: Claude AI